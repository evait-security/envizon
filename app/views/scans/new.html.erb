<div class="container mt-5">
  <%= simple_form_for :scan, url: scans_create_path, remote: true, authenticity_token: true,  html: {multipart: true} do |f| %>
    <input id="scan_name" name="scan[name]" type="hidden" value="Custom scan">
    <label class="string required" for="command">Scan parameters <abbr title="required">*</abbr></label>
    <div class="input-group">
      <input type="text" id="command" name="scan[command]" class="form-control" placeholder="Use your own nmap fu ... ">
      <button class="btn btn-outline-primary dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false">or predefined parameters</button>
      <ul class="dropdown-menu dropdown-menu-end">
        <% SavedScan.all.to_a.each do | saved_scan | %>
          <li>
            <a class="dropdown-item" href="#" onclick="$('#command').val('<%= saved_scan.parameter %>');">
              <%= saved_scan.name %>
            </a>
          </li>
        <% end %>
      </ul>
    </div>
    <label class="string required" for="scan_target">Targets <abbr title="required">*</abbr></label>
    <div class="input-group">
      <input class="form-control string required" required="required" aria-required="true" placeholder="e.g. 192.168.1.0/24 192.168.1-10.0/24 192.168.1.0-192.168.10.0/255.255.255.0" type="text" name="scan[target]" id="scan_target">
      <div class="input-group-text">
        <span class="me-2">or scan all active clients</span>
        <input class="form-check-input mt-0" name="all_clients" id="check_scan_all_clients" type="checkbox" value="true" aria-label="Checkbox for following text input">
      </div>
      <button type="submit" class="btn btn-primary"><i class="fas fa-coffee me-2"></i>Start new scan</button>
    </div>
  <% end %>
  <%= simple_form_for :scan, url: scans_upload_path, remote: true, authenticity_token: true, html: {multipart: true, class: "mt-5"} do |f| %>
    <input id="scan_name" name="name" type="hidden" value="Custom scan">
    <div class="row">
      <label for="xml_file_" class="form-label string required">Upload one or several xml files generated by nmap using the -oX argument <abbr title="required">*</abbr></label>
      <div class="col">
        <div class="form-group string required">
          <input class="form-control" name="xml_file[]" accept=".xml"  type="file" id="xml_file_" multiple>
        </div>
      </div>
      <div class="col-auto">
        <button type="submit" class="btn btn-primary"><i class="fas fa-coffee me-2"></i>Import</button>
      </div>
    </div>
  <% end %>
</div>

<script>
  $(document).on("click", '#check_scan_all_clients', function () {
    $("#scan_target").prop('disabled', function(i, v) { return !v; }); // toogle property
    $(this).blur();
  });
</script>
