<div class="scans-page">
  <div class="row" style="padding-top: 2em;">
    <div class="col offset-s2 s8">
      <div class="container">
        <div class="row">
          <div class="col s12">
            <ul class="tabs tabs-fixed-width">
              <li class="tab col s3"><a href="#prescan">Preconfigured Scan</a></li>
              <li class="tab col s3"><a href="#upload">Upload nmap-XML</a></li>
              <li class="tab col s3"><a href="#manscan">Manual Scan</a></li>
            </ul>
          </div>
          <div id="prescan" class="col s12">
            <div class="white">
              <div class="container">
                <div class="row" style="padding: 2em;">
                  <%= simple_form_for :scan, url: scans_create_path, remote: true, authenticity_token: true,  html: {multipart: true} do |f| %>
                    <div class="input-field col s8">
                      <select name="command" onchange="if (this.selectedIndex) setSavedScanLabel(this.options[this.selectedIndex].value);">
                        <option value="" disabled selected>Choose an option</option>
                        <% SavedScan.all.to_a.each do | saved_scan | %>
                          <option value="<%= saved_scan.parameter %>"><%= saved_scan.name %></option>
                        <% end %>
                      </select>
                      <label id="savedScanLabel">Scan Parameters*</label>
                    </div>
                    <div class="input-field col s4">
                      <input id="scan_target" placeholder="e.g. 10.4.10.0/24" name="target" type="text" class="validate">
                      <label for="scan_target">Target*</label>
                    </div>
                    <div class="input-field col s8">
                      <input id="scan_name" placeholder="e.g. internal network" name="name" type="text" class="validate">
                      <label for="scan_name">Name*</label>
                    </div>
                    <div class="input-field col s3">
                      <button class="btn" type="submit" name="action"><i class="fa fa-coffee"></i></button>
                    </div>
                    <div class="input-field col s1">
                      <i class="material-icons tooltipped" data-position="bottom" data-delay="50" data-tooltip="These scans are preconfigured and can be modified in the settings page.">info_outline</i>
                    </div>
                  <% end %>
                </div>
              </div>
            </div>
          </div>
          <div id="upload" class="col s12">
            <div class="white">
              <div class="container">
                <div class="row" style="padding: 2em;">
                  <%= simple_form_for :scan, url: scans_upload_path, remote: true, authenticity_token: true, html: {multipart: true} do |f| %>
                    <div class="file-field input-field col s12">
                      <div class="btn btn-small">
                        <i class="fa fa-code"></i>
                        <input id="xml_file_" name="xml_file[]" type="file" accept=".xml" multiple>
                      </div>
                      <div class="file-path-wrapper">
                        <input class="file-path validate" type="text" placeholder="Upload one or several files">
                      </div>
                    </div>
                    <div class="input-field col s8">
                      <input id="scan_name" name="name" placeholder="e.g. internal network" type="text" class="validate">
                      <label for="scan_name">Scan Name</label>
                    </div>
                    <div class="input-field col s3">
                      <button class="btn" type="submit" name="action"><i class="fa fa-upload"></i></button>
                    </div>
                    <div class="input-field col s1">
                      <i class="material-icons tooltipped" data-position="bottom" data-delay="50" data-tooltip="Here you can upload nmap results generated by the '-oX' parameter">info_outline</i>
                    </div>
                  <% end %>
                </div>
              </div>
            </div>
          </div>
          <div id="manscan" class="col s12">
            <div class="white">
              <div class="container">
                <div class="row" style="padding: 2em;">
                  <%= simple_form_for :scan, url: scans_create_path, remote: true, authenticity_token: true,  html: {multipart: true} do |f| %>
                    <div class="input-field col s8">
                      <input id="scan_paramater" placeholder="e.g. -sV -p 8000,252,447 -n" name="command" type="text" class="validate">
                      <label for="scan_paramater">Nmap Parameter*</label>
                    </div>
                    <div class="input-field col s4">
                      <input id="scan_target" placeholder="e.g. 10.4.10.0/24" name="target" type="text" class="validate">
                      <label for="scan_target">Target*</label>
                    </div>
                    <div class="input-field col s8">
                      <input id="scan_name" placeholder="e.g. internal network" name="name" type="text" class="validate">
                      <label for="scan_name">Name*</label>
                    </div>
                    <div class="input-field col s3">
                      <button class="btn" type="submit" name="action"><i class="fa fa-coffee"></i></button>
                    </div>
                    <div class="input-field col s1">
                      <i class="material-icons tooltipped" data-position="bottom" data-delay="50" data-tooltip="Here you can start custom nmap scans. Some parameters (like '-oX') will be ignored/stripped from your input.">info_outline</i>
                    </div>
                  <% end %>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
  function setSavedScanLabel(saved_scan){
    $("#savedScanLabel")[0].innerHTML = "Scan Parameter* ( " + saved_scan + " )";
  }
</script>